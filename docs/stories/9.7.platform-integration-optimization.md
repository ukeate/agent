# Story 9.7: å¹³å°é›†æˆå’Œä¼˜åŒ–

**æ•…äº‹ID**: STORY-9.7-PLATFORM-INTEGRATION  
**Epic**: Epic 9 - æ¨¡å‹å¾®è°ƒå’Œä¼˜åŒ–å¹³å°  
**ä¼˜å…ˆçº§**: P1  
**é¢„ä¼°å·¥æœŸ**: 1-2å‘¨  
**æ•…äº‹ç‚¹æ•°**: 13  
**è´Ÿè´£å›¢é˜Ÿ**: AIå›¢é˜Ÿ + DevOpså›¢é˜Ÿ

## ğŸ“‹ ç”¨æˆ·æ•…äº‹

ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜å’ŒAIå·¥ç¨‹å¸ˆï¼Œæˆ‘éœ€è¦ä¸€ä¸ªå®Œæ•´é›†æˆçš„æ¨¡å‹å¾®è°ƒå’Œä¼˜åŒ–å¹³å°ï¼Œæ”¯æŒç«¯åˆ°ç«¯çš„æ¨¡å‹å¼€å‘ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œå…·å¤‡å®Œå–„çš„ç›‘æ§å‘Šè­¦å’Œæ–‡æ¡£æ”¯æŒï¼Œä»¥ä¾¿é«˜æ•ˆåœ°è¿›è¡Œæ¨¡å‹è®­ç»ƒã€ä¼˜åŒ–å’Œéƒ¨ç½²å·¥ä½œã€‚

### ğŸ¯ ç”¨æˆ·ä»·å€¼

- **ç«¯åˆ°ç«¯é›†æˆ**: ç»Ÿä¸€çš„å¹³å°ç•Œé¢ç®¡ç†æ‰€æœ‰å¾®è°ƒå’Œä¼˜åŒ–ç»„ä»¶
- **æ™ºèƒ½ç›‘æ§**: å…¨æ–¹ä½ç›‘æ§å‘Šè­¦ç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œ
- **æ€§èƒ½ä¼˜åŒ–**: ç³»ç»Ÿæ€§èƒ½æå‡30%+ï¼Œå“åº”æ—¶é—´<2ç§’
- **å®Œå–„æ–‡æ¡£**: é™ä½90%+å­¦ä¹ æˆæœ¬å’Œè¿ç»´å¤æ‚åº¦

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½è¦æ±‚
- [ ] **ç«¯åˆ°ç«¯é›†æˆ**: æ‰€æœ‰å¾®è°ƒå’Œä¼˜åŒ–ç»„ä»¶æˆåŠŸé›†æˆ
- [ ] **å·¥ä½œæµç¼–æ’**: æ”¯æŒå®Œæ•´çš„è®­ç»ƒ-ä¼˜åŒ–-éƒ¨ç½²å·¥ä½œæµ
- [ ] **æ€§èƒ½ç›‘æ§**: å®æ—¶ç›‘æ§CPUã€å†…å­˜ã€GPUèµ„æºä½¿ç”¨
- [ ] **å‘Šè­¦ç®¡ç†**: å¼‚å¸¸æ£€æµ‹å‡†ç¡®ç‡>95%ï¼Œå“åº”æ—¶é—´<1åˆ†é’Ÿ
- [ ] **ç»Ÿä¸€é…ç½®**: æ”¯æŒå¤šç¯å¢ƒé…ç½®å’Œçƒ­æ›´æ–°
- [ ] **æ–‡æ¡£ç³»ç»Ÿ**: è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£å’Œç”¨æˆ·æŒ‡å—

### æŠ€æœ¯è¦æ±‚
- [ ] **å“åº”æ€§èƒ½**: å¹³å°å“åº”æ—¶é—´<2ç§’
- [ ] **å¹¶å‘èƒ½åŠ›**: æ”¯æŒ10ä¸ªå¹¶å‘è®­ç»ƒä»»åŠ¡
- [ ] **ç³»ç»Ÿå¯ç”¨æ€§**: å¯ç”¨æ€§>99.5%
- [ ] **ç›‘æ§è¦†ç›–**: æ‰€æœ‰å…³é”®ç»„ä»¶å’Œä¸šåŠ¡æŒ‡æ ‡100%è¦†ç›–
- [ ] **ä»£ç è´¨é‡**: æµ‹è¯•è¦†ç›–ç‡â‰¥85%ï¼Œæ— é«˜å±å®‰å…¨æ¼æ´

### æ€§èƒ½æŒ‡æ ‡
- [ ] **é›†æˆå®Œæ•´æ€§**: ç»„ä»¶é—´æ•°æ®ä¼ é€’å’ŒçŠ¶æ€åŒæ­¥æ­£å¸¸
- [ ] **èµ„æºä¼˜åŒ–**: å†…å­˜ä½¿ç”¨æ•ˆç‡æå‡30%
- [ ] **æ•…éšœæ¢å¤**: å¹³å‡æ•…éšœæ¢å¤æ—¶é—´<5åˆ†é’Ÿ
- [ ] **æ–‡æ¡£è´¨é‡**: APIæ–‡æ¡£è¦†ç›–ç‡100%ï¼Œç”¨æˆ·æ»¡æ„åº¦>4.0/5.0

## ğŸ—ï¸ å®ç°æ–¹æ¡ˆ

### ç³»ç»Ÿæ¶æ„

```mermaid
graph TB
    A[APIç½‘å…³] --> B[å¹³å°é›†æˆå™¨]
    B --> C1[å¾®è°ƒæœåŠ¡]
    B --> C2[å‹ç¼©æœåŠ¡]
    B --> C3[è¶…å‚æ•°ä¼˜åŒ–]
    B --> C4[è¯„ä¼°æœåŠ¡]
    B --> C5[æ•°æ®ç®¡ç†]
    B --> C6[æ¨¡å‹æœåŠ¡]
    
    D[ç›‘æ§ç³»ç»Ÿ] --> E[æ€§èƒ½æŒ‡æ ‡æ”¶é›†]
    F[é…ç½®ä¸­å¿ƒ] --> B
    G[æ–‡æ¡£ç”Ÿæˆå™¨] --> H[APIæ–‡æ¡£]
    I[å·¥ä½œæµå¼•æ“] --> B
```

### æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### 1. å¹³å°é›†æˆå™¨
- **ç»„ä»¶æ³¨å†Œ**: è‡ªåŠ¨å‘ç°å’Œæ³¨å†Œå¾®æœåŠ¡ç»„ä»¶
- **å¥åº·ç›‘æ§**: ç»„ä»¶å¥åº·çŠ¶æ€æ£€æŸ¥å’Œæ•…éšœæ¢å¤
- **è´Ÿè½½å‡è¡¡**: æ™ºèƒ½è¯·æ±‚è·¯ç”±å’Œè´Ÿè½½åˆ†é…
- **å·¥ä½œæµç¼–æ’**: ç«¯åˆ°ç«¯è®­ç»ƒæµç¨‹è‡ªåŠ¨åŒ–

#### 2. æ€§èƒ½ä¼˜åŒ–å™¨
- **ç“¶é¢ˆåˆ†æ**: CPUã€å†…å­˜ã€IOæ€§èƒ½ç“¶é¢ˆè¯†åˆ«
- **ç¼“å­˜ä¼˜åŒ–**: å¤šçº§ç¼“å­˜ç­–ç•¥å’Œçƒ­ç‚¹æ•°æ®é¢„åŠ è½½
- **è¿æ¥æ± ç®¡ç†**: æ•°æ®åº“å’ŒRedisè¿æ¥æ± ä¼˜åŒ–
- **èµ„æºè°ƒåº¦**: åŠ¨æ€èµ„æºåˆ†é…å’Œè´Ÿè½½å‡è¡¡

#### 3. ç›‘æ§å‘Šè­¦ç³»ç»Ÿ
- **æŒ‡æ ‡æ”¶é›†**: Prometheusé›†æˆå’Œè‡ªå®šä¹‰æŒ‡æ ‡
- **å¯è§†åŒ–**: Grafanaä»ªè¡¨æ¿å’Œå®æ—¶ç›‘æ§
- **æ™ºèƒ½å‘Šè­¦**: åŸºäºé˜ˆå€¼å’Œè¶‹åŠ¿çš„å‘Šè­¦è§„åˆ™
- **æ•…éšœåˆ†æ**: è‡ªåŠ¨æ ¹å› åˆ†æå’Œä¿®å¤å»ºè®®

#### 4. æ–‡æ¡£ç”Ÿæˆå™¨
- **APIæ–‡æ¡£**: OpenAPIè§„èŒƒè‡ªåŠ¨ç”Ÿæˆ
- **ç”¨æˆ·æŒ‡å—**: äº¤äº’å¼ä½¿ç”¨æ•™ç¨‹
- **å¼€å‘æ–‡æ¡£**: ç»„ä»¶å¼€å‘å’Œé›†æˆæŒ‡å—
- **æ•…éšœæ‰‹å†Œ**: å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### æ•°æ®æ¨¡å‹

#### å¹³å°ç»„ä»¶è¡¨ (platform_components)
```sql
CREATE TABLE platform_components (
    id UUID PRIMARY KEY,
    component_id VARCHAR(255) UNIQUE NOT NULL,
    component_type VARCHAR(100) NOT NULL,
    name VARCHAR(255) NOT NULL,
    version VARCHAR(50) NOT NULL,
    status VARCHAR(50),
    health_endpoint VARCHAR(500),
    api_endpoint VARCHAR(500),
    metadata JSONB,
    registered_at TIMESTAMP WITH TIME ZONE,
    last_heartbeat TIMESTAMP WITH TIME ZONE
);
```

#### å·¥ä½œæµæ‰§è¡Œè®°å½• (workflow_executions)
```sql
CREATE TABLE workflow_executions (
    id UUID PRIMARY KEY,
    workflow_id VARCHAR(255) UNIQUE NOT NULL,
    workflow_type VARCHAR(100) NOT NULL,
    status VARCHAR(50) NOT NULL,
    parameters JSONB,
    steps JSONB,
    started_at TIMESTAMP WITH TIME ZONE,
    completed_at TIMESTAMP WITH TIME ZONE
);
```

### APIæ¥å£è®¾è®¡

#### RESTful APIè§„èŒƒ
- `POST /platform/components/register` - æ³¨å†Œç»„ä»¶
- `GET /platform/components` - åˆ—å‡ºæ‰€æœ‰ç»„ä»¶
- `POST /platform/workflows/run` - æ‰§è¡Œå·¥ä½œæµ
- `GET /platform/workflows/{id}/status` - è·å–å·¥ä½œæµçŠ¶æ€
- `GET /platform/health` - å¹³å°å¥åº·æ£€æŸ¥
- `GET /platform/metrics` - è·å–æ€§èƒ½æŒ‡æ ‡

#### ç»„ä»¶æ³¨å†Œç¤ºä¾‹
```python
# ç»„ä»¶æ³¨å†Œæ¥å£
@app.post("/platform/components/register")
async def register_component(component: ComponentRegistration):
    component_info = ComponentInfo(
        component_id=component.component_id,
        component_type=component.component_type,
        name=component.name,
        version=component.version,
        status=ComponentStatus.STARTING,
        health_endpoint=component.health_endpoint,
        api_endpoint=component.api_endpoint
    )
    await platform_integrator.register_component(component_info)
    return {"status": "success", "component_id": component.component_id}

# å·¥ä½œæµæ‰§è¡Œæ¥å£
@app.post("/platform/workflows/run")
async def run_workflow(workflow: WorkflowRequest):
    result = await workflow_engine.execute_workflow(workflow)
    return {"workflow_id": result.workflow_id, "status": result.status}
```

### ç›‘æ§é…ç½®

#### PrometheusæŒ‡æ ‡å®šä¹‰
```yaml
metrics:
  - name: platform_requests_total
    type: counter
    help: "Total number of platform requests"
  - name: platform_request_duration_seconds
    type: histogram
    help: "Request duration in seconds"
  - name: platform_memory_usage_bytes
    type: gauge
    help: "Memory usage in bytes"
  - name: platform_active_training_jobs
    type: gauge
    help: "Number of active training jobs"
```

#### Grafanaä»ªè¡¨æ¿é…ç½®
```json
{
  "dashboard": {
    "title": "Platform Overview",
    "panels": [
      {
        "title": "Request Rate",
        "targets": ["rate(platform_requests_total[5m])"]
      },
      {
        "title": "Response Time P95",
        "targets": ["histogram_quantile(0.95, platform_request_duration_seconds)"]
      },
      {
        "title": "Memory Usage",
        "targets": ["platform_memory_usage_bytes"]
      }
    ]
  }
}
```

## ğŸ“‹ Tasks / Subtasks

- [ ] **Task 1**: å®ç°å¹³å°é›†æˆæ¡†æ¶ (AC: 1, 2)
  - [ ] æ„å»ºç»„ä»¶æ³¨å†Œå’Œå‘ç°æœºåˆ¶
  - [ ] å®ç°ç»Ÿä¸€APIç½‘å…³
  - [ ] é›†æˆç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
  - [ ] å»ºç«‹ç»„ä»¶é—´é€šä¿¡åè®®

- [ ] **Task 2**: å¼€å‘å·¥ä½œæµç¼–æ’å¼•æ“ (AC: 2)
  - [ ] å®ç°ç«¯åˆ°ç«¯è®­ç»ƒæµç¨‹
  - [ ] æ·»åŠ å·¥ä½œæµçŠ¶æ€ç®¡ç†
  - [ ] é›†æˆé”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
  - [ ] å®ç°å·¥ä½œæµå¯è§†åŒ–ç›‘æ§

- [ ] **Task 3**: æ„å»ºæ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿ (AC: 3, 5)
  - [ ] å®ç°æ€§èƒ½ç“¶é¢ˆåˆ†æ
  - [ ] ä¼˜åŒ–ç¼“å­˜å’Œè¿æ¥æ± ç­–ç•¥
  - [ ] æ·»åŠ èµ„æºç›‘æ§å’Œè°ƒåº¦
  - [ ] å®ç°è‡ªåŠ¨åŒ–æ€§èƒ½è°ƒä¼˜

- [ ] **Task 4**: é›†æˆç›‘æ§å‘Šè­¦ç³»ç»Ÿ (AC: 4)
  - [ ] é…ç½®Prometheus+Grafanaç›‘æ§
  - [ ] å®ç°ä¸šåŠ¡æŒ‡æ ‡æ”¶é›†
  - [ ] å»ºç«‹æ™ºèƒ½å‘Šè­¦è§„åˆ™
  - [ ] é›†æˆæ•…éšœè‡ªåŠ¨æ¢å¤

- [ ] **Task 5**: å¼€å‘ç»Ÿä¸€é…ç½®ç®¡ç† (AC: 5)
  - [ ] å®ç°å¤šç¯å¢ƒé…ç½®æ”¯æŒ
  - [ ] æ·»åŠ é…ç½®çƒ­æ›´æ–°åŠŸèƒ½
  - [ ] é›†æˆé…ç½®ç‰ˆæœ¬æ§åˆ¶
  - [ ] å®ç°é…ç½®å®‰å…¨ç®¡ç†

- [ ] **Task 6**: æ„å»ºæ–‡æ¡£ç³»ç»Ÿ (AC: 6)
  - [ ] è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£
  - [ ] ç¼–å†™å®Œæ•´ç”¨æˆ·æŒ‡å—
  - [ ] åˆ¶ä½œå¼€å‘è€…æ–‡æ¡£
  - [ ] å»ºç«‹çŸ¥è¯†åº“å’ŒFAQ

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
- ç»„ä»¶æ³¨å†Œå’Œå‘ç°åŠŸèƒ½æµ‹è¯•
- å·¥ä½œæµæ‰§è¡Œé€»è¾‘æµ‹è¯•
- æ€§èƒ½ä¼˜åŒ–ç®—æ³•æµ‹è¯•
- ç›‘æ§æŒ‡æ ‡æ”¶é›†æµ‹è¯•

### é›†æˆæµ‹è¯•
- ç«¯åˆ°ç«¯å·¥ä½œæµé›†æˆæµ‹è¯•
- å¤šç»„ä»¶ååŒå·¥ä½œæµ‹è¯•
- è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»æµ‹è¯•
- ç›‘æ§å‘Šè­¦æµç¨‹æµ‹è¯•

### æ€§èƒ½æµ‹è¯•
- é«˜å¹¶å‘è¯·æ±‚å¤„ç†æµ‹è¯•
- ç³»ç»Ÿèµ„æºä½¿ç”¨ä¼˜åŒ–æµ‹è¯•
- å“åº”æ—¶é—´å’Œååé‡æµ‹è¯•
- é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§æµ‹è¯•

### å‹åŠ›æµ‹è¯•
- æé™å¹¶å‘åœºæ™¯æµ‹è¯•
- èµ„æºè€—å°½æ¢å¤æµ‹è¯•
- ç»„ä»¶æ•…éšœå½±å“æµ‹è¯•
- ç³»ç»Ÿè¾¹ç•Œæ¡ä»¶æµ‹è¯•

## ğŸ“¦ éƒ¨ç½²é…ç½®

### Dockeré…ç½®
```dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY src/ .
EXPOSE 8000
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```

### Kubernetesé…ç½®
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: platform-integration
spec:
  replicas: 3
  template:
    spec:
      containers:
      - name: platform
        image: model-platform:latest
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /platform/health
            port: 8000
        readinessProbe:
          httpGet:
            path: /platform/ready
            port: 8000
```

## ğŸ“Š ç›‘æ§å’Œå‘Šè­¦

### å…³é”®æŒ‡æ ‡
- å¹³å°æ•´ä½“å“åº”æ—¶é—´å’Œååé‡
- å„ç»„ä»¶å¥åº·çŠ¶æ€å’Œå¯ç”¨æ€§
- å·¥ä½œæµæ‰§è¡ŒæˆåŠŸç‡å’Œæ€§èƒ½
- ç³»ç»Ÿèµ„æºä½¿ç”¨ç‡å’Œè¶‹åŠ¿
- ç”¨æˆ·æ“ä½œç»Ÿè®¡å’Œæ»¡æ„åº¦

### å‘Šè­¦è§„åˆ™
- å¹³å°å“åº”æ—¶é—´è¶…è¿‡2ç§’
- ç»„ä»¶å¥åº·æ£€æŸ¥å¤±è´¥è¶…è¿‡3æ¬¡
- å·¥ä½œæµæ‰§è¡Œå¤±è´¥ç‡è¶…è¿‡5%
- ç³»ç»Ÿå†…å­˜ä½¿ç”¨ç‡è¶…è¿‡85%
- APIé”™è¯¯ç‡è¶…è¿‡1%

---

**Status**: Draft  
**Created**: 2025-08-30  
**Last Updated**: 2025-08-30  
**Dependencies**: Epic 9.1-9.6 å…¨éƒ¨å®Œæˆ  
**Technical Lead**: AIå›¢é˜Ÿ  
**Stakeholders**: DevOpså›¢é˜Ÿ, æ¶æ„å›¢é˜Ÿ, äº§å“å›¢é˜Ÿ